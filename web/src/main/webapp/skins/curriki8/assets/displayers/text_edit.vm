#asset_displaycontentheader("")
<div class="asset-display-edit">
    <div class="asset-display-edit-inner">
        <form name="text" action="$xwiki.getURL("CurrikiCode.AssetSaveService", "view")" onsubmit="return beforeAssetSubmit(this);" method="post" >
            #set($xredirect = $xwiki.getFormEncoded($asset.getURL('view', $!request.queryString.replaceAll("viewer=assetedit", ""))))
            <input  type="hidden" name="page" value="$asset.fullName" />
            <input  type="hidden" name="xredirect" value="$xredirect" />
            <fieldset>
                <ul>
                    $asset.use("CurrikiCode.TextAssetClass")
                    #set($syntax = $asset.getValue("syntax"))
                    #if($syntax=="xwiki/1.0")
                    <li class="input-textarea">
                        <p>$msg.get("rve.content.edit.text.instruction_text.wiki_wysiwyg")</p>
                        <div id="input-wiki-wysiwyg">
                          $asset.getTextArea()
                        </div>
                    </li>
                    <script type="text/javascript" src="${request.contextPath}/tiny_mce/tiny_mce.js"></script>
                    <script type="text/javascript" src="${request.contextPath}/wiki_editor/wiki_editor.js"></script>
                    <script language="javascript" type="text/javascript">
                        if ( browser.isIE || browser.isMozilla || browser.isGecko) {
                            wikiEditor.init({
                                language: "en",
                                elements : "content",
                                mode: "exact",
                                content_css: "$xwiki.getSkinFile("style.css", true)",
                                debug : false,
                                remove_linebreaks : false,
                                plugins: 'table, contextmenu, paste, searchreplace',
                                wiki_images_path : '${request.contextPath}/bin/download/$asset.web/$asset.name/',
                                wiki_attach_path : '${request.contextPath}/bin/view/$asset.web/$asset.name',
                                wiki_macro_path : '${request.contextPath}/bin/view/$asset.web/$asset.name',
                                wiki_plugins: 'core,attachments'
                            });
                        } else {
                            alert("$msg.get('browsernoncompatible')");
                        }
                    </script>
                    #elseif($syntax=="xhtml/1.0")
                    <li class="input-textarea">
                        <p>$msg.get("rve.content.edit.text.instruction_text.html_wysiwyg")</p>
                        <div id="input-html-wysiwyg">
                          $asset.getTextArea()
                        </div>
                    </li>
                    <script type="text/javascript" src="${request.contextPath}/tiny_mce32/tiny_mce.js"></script>
                    <script type="text/javascript">
                        tinyMCE.init({
                            // General options
                            language: "en",
                            mode : "exact",
                            elements : "content",
                            theme : "advanced",
                            plugins : "safari,table,save,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,media,searchreplace,print,contextmenu,paste,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras",

                            // Theme options
                            theme_advanced_buttons1 : "bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,formatselect,fontselect,fontsizeselect,forecolor,backcolor",
                            theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,image,media,cleanup,help,code",
                            theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,fullscreen",
                            theme_advanced_toolbar_location : "top",
                            theme_advanced_toolbar_align : "left",
                            theme_advanced_statusbar_location : "",
                            theme_advanced_resizing : true,

                            // Example content CSS (should be your site CSS)
                            // content_css : "css/content.css",

                            // Drop lists for link/image/media/template dialogs
                            // external_link_list_url : "lists/link_list.js",
                            // external_image_list_url : "lists/image_list.js",
                            // media_external_list_url : "lists/media_list.js",
                        });
                    </script>
                    #else
                    <li class="input-textarea">
                        <div id="input-text-wysiwyg">
                          $asset.getTextArea()
                        </div>
                    </li>
                    #end
                    #asset_edit_revision()
                </ul>
            </fieldset>
            <hr>
            #asset_edit_buttons($asset true)
        </form>
        ## this allows to check for changes
        #curriki_clickawayjs("text" $xwiki.escapeText($msg.get("rve.content.edit.warning.message_text")))        
    </div>
</div>
#asset_displaycontentfooter()
