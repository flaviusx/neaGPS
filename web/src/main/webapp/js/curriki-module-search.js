(function(){Ext.ns("Curriki.module.search");var A=Curriki.module.search;A.stateProvider=new Ext.state.CookieProvider({});Ext.state.Manager.setProvider(A.stateProvider);A.sessionProvider=new Ext.state.CookieProvider({expires:null})})();(function(){Ext.ns("Curriki.module.search.util");var A=Curriki.module.search;var B=A.util;B.init=function(){console.log("search util: init");B.registerTabTitleListener=function(C){Ext.StoreMgr.lookup("search-store-"+C).addListener("datachanged",function(){var D=Ext.getCmp("search-"+C+"-tab");if(!Ext.isEmpty(D)){D.setTitle(_("search."+C+".tab.title")+" ("+Ext.StoreMgr.lookup("search-store-"+C).getTotalCount()+")")}})};B.doSearch=function(G){var E={};var D=Ext.getCmp("search-termPanel");if(!Ext.isEmpty(D)){var F=D.getForm();if(!Ext.isEmpty(F)){Ext.apply(E,F.getValues(false))}}Ext.apply(E,{module:G});D=Ext.getCmp("search-filterPanel-"+G);if(!Ext.isEmpty(D)){var F=D.getForm();if(!Ext.isEmpty(F)){Ext.apply(E,F.getValues(false))}}if(E.terms&&E.terms===_("search.text.entry.label")){E.terms=""}console.log("Searching",E);Ext.apply(Ext.StoreMgr.lookup("search-store-"+G).baseParams||{},E);var C=Ext.getCmp("search-pager-"+G);if(!Ext.isEmpty(C)){C.doLoad(0)}};B.createTermPanel=function(D,C){return{xtype:"panel",labelAlign:"left",id:"search-termPanel-"+D,border:false,items:[{layout:"column",border:false,defaults:{border:false},items:[{columnWidth:0.7,layout:"form",items:[{xtype:"textfield",fieldLabel:_("search.text.entry.label"),name:"terms",hideLabel:true,emptyText:_("search.text.entry.label"),listeners:{specialkey:{fn:function(F,E){if(E.getKey()===Ext.EventObject.ENTER){A.doSearch(D)}}}}}]},{columnWidth:0.15,xtype:"box",autoEl:{html:'<a href="/xwiki/bin/view/Search/Tips?xpage=popup" target="search_tips">'+_("search.text.entry.help.button")+"</a>"}},{columnWidth:0.1,layout:"form",items:[{xtype:"button",text:_("search.text.entry.button"),listeners:{click:{fn:function(){A.doSearch(D)}}}}]}]},{xtype:"hidden",name:"since",value:(new Date()).add(Date.DAY,-_("search.resource.special.selector.updated.days")).format("Ymd")},{xtype:"hidden",name:"other",value:(!Ext.isEmpty(A.restrictions)?A.restrictions:"")}]}};B.fieldsetPanelSave=function(C,D){if(Ext.isEmpty(D)){D={}}if(!C.collapsed){D.collapsed=C.collapsed}else{D=null}console.log("fieldset Panel Save state:",D);A.sessionProvider.set(C.stateId||C.id,D)};B.fieldsetPanelRestore=function(C,D){if(!Ext.isEmpty(D)&&!Ext.isEmpty(D.collapsed)&&!D.collapsed){C.expand(false)}}};Ext.onReady(function(){B.init()})})();(function(){var B="resource";Ext.ns("Curriki.module.search.data."+B);var A=Curriki.module.search.data.resource;A.init=function(){console.log("data."+B+": init");A.filter={};var C=A.filter;C.data={};C.data.subject={mapping:Curriki.data.fw_item.fwMap["FW_masterFramework.WebHome"],list:[],data:[["",_("XWiki.AssetClass_fw_items_FW_masterFramework.UNSPECIFIED")]]};C.data.subject.mapping.each(function(D){C.data.subject.list.push(D.id)});C.data.subject.list.each(function(D){C.data.subject.data.push([D,_("XWiki.AssetClass_fw_items_"+D)])});C.data.subsubject={mapping:Curriki.data.fw_item.fwMap,data:[]};C.data.subject.mapping.each(function(D){C.data.subsubject.data.push([D.id,_("XWiki.AssetClass_fw_items_"+D.id+".UNSPECIFIED"),D.id]);C.data.subsubject.mapping[D.id].each(function(E){C.data.subsubject.data.push([E.id,_("XWiki.AssetClass_fw_items_"+E.id),D.id])})});C.data.level={list:Curriki.data.el.list,data:[["",_("XWiki.AssetClass_educational_level2_UNSPECIFIED")]]};C.data.level.list.each(function(D){C.data.level.data.push([D,_("XWiki.AssetClass_educational_level2_"+D)])});C.data.ict={fullList:Curriki.data.ict.list,parentList:{},list:[],data:[["",_("XWiki.AssetClass_instructional_component2_UNSPECIFIED")]]};C.data.ict.fullList.each(function(E){var D=E.replace(/_.*/,"");C.data.ict.parentList[D]=D});Object.keys(C.data.ict.parentList).each(function(D){C.data.ict.data.push([D,_("XWiki.AssetClass_instructional_component2_"+D)])});C.data.subict={list:Curriki.data.ict.list,parents:{},data:[]};C.data.subict.list.each(function(E){var D=E.replace(/_.*/,"");if(D!==E){if(Ext.isEmpty(C.data.subict.parents[D])){C.data.subict.data.push([D+"*",_("XWiki.AssetClass_instructional_component2_"+D+"_UNSPECIFIED"),D]);C.data.subict.parents[D]=D}C.data.subict.data.push([E,_("XWiki.AssetClass_instructional_component2_"+E),D])}});C.data.language={list:Curriki.data.language.list,data:[["",_("XWiki.AssetClass_language_UNSPECIFIED")]]};C.data.language.list.each(function(D){C.data.language.data.push([D,_("XWiki.AssetClass_language_"+D)])});C.data.review={list:["partners","highest_rated"],data:[["",_("search.resource.review.selector.UNSPECIFIED")]]};C.data.review.list.each(function(D){C.data.review.data.push([D,_("search.resource.review.selector."+D)])});C.data.special={list:["contributions","collections","updated"],data:[["",_("search.resource.special.selector.UNSPECIFIED")]]};C.data.special.list.each(function(D){C.data.special.data.push([D,_("search.resource.special.selector."+D)])});C.store={subject:new Ext.data.SimpleStore({fields:["id","subject"],data:C.data.subject.data,id:0}),subsubject:new Ext.data.SimpleStore({fields:["id","subject","parentItem"],data:C.data.subsubject.data,id:0}),level:new Ext.data.SimpleStore({fields:["id","level"],data:C.data.level.data,id:0}),ict:new Ext.data.SimpleStore({fields:["id","ict"],data:C.data.ict.data,id:0}),subict:new Ext.data.SimpleStore({fields:["id","ict","parentICT"],data:C.data.subict.data,id:0}),language:new Ext.data.SimpleStore({fields:["id","language"],data:C.data.language.data,id:0}),review:new Ext.data.SimpleStore({fields:["id","review"],data:C.data.review.data,id:0}),special:new Ext.data.SimpleStore({fields:["id","special"],data:C.data.special.data,id:0})};A.store={};A.store.record=new Ext.data.Record.create([{name:"title"},{name:"assetType"},{name:"ict"},{name:"ictText"},{name:"ictIcon"},{name:"contributor"},{name:"contributorName"},{name:"rating",mapping:"review"},{name:"description"},{name:"info"},{name:"updated"}]);A.store.results=new Ext.data.Store({storeId:"search-store-"+B,proxy:new Ext.data.HttpProxy({url:"/xwiki/bin/view/Search/Resources",method:"GET"}),baseParams:{xpage:"plain"},reader:new Ext.data.JsonReader({root:"rows",totalProperty:"resultCount",id:"page"},A.store.record),remoteSort:true});A.store.results.setDefaultSort("title","asc");A.renderer={assetType:function(I,G,D,J,F,E){G.css=String.format("resource-{0}",I);var H=_("search.resource.icon."+I+".rollover");if(H==="search.resource.icon."+I+".rollover"){H=_("search.resource.icon.Unknown.rollover")}return String.format('<img class="x-tree-node-icon assettype-icon" style="width:16px;height:17px;background-repeat:no-repeat;" src="{0}" alt="{1}" ext:qtip="{1}" />',Ext.BLANK_IMAGE_URL,H)},title:function(J,I,D,H,L,K){var G=D.id.replace(/\./,"/");var E=Ext.util.Format.stripTags(D.data.description);E=Ext.util.Format.ellipsis(E,300);E=Ext.util.Format.htmlEncode(E);var F=D.data.assetType;I.css=String.format("resource-{0}",F);var M=_("search.resource.icon."+F+".rollover");if(M==="search.resource.icon."+F+".rollover"){M=_("search.resource.icon.Unknown.rollover")}return String.format('<img class="x-tree-node-icon assettype-icon" src="{4}" alt="{5}" ext:qtip="{5}" /><a href="/xwiki/bin/view/{0}" class="asset-title" ext:qtitle="{3}" ext:qtip="{2}">{1}</a>',G,J,E,_("search.resource.column.title.tooltip.title"),Ext.BLANK_IMAGE_URL,M)},ict:function(K,J,G,I,M,L){var H;var E;var F=G.data.ict;if(!Ext.isEmpty(F)){var D=F.replace(/_.*/,"");H="ict-"+D;if(D!==F){H=H+" ict-"+F}E=F.replace(/_/,".")}else{H="ict-unknown";E="unknown"}J.css=H;return String.format('<img class="ict-icon" src="{1}" /><span class="ict-title">{0}</span>',_("search.resource.ict."+E),Ext.BLANK_IMAGE_URL)},contributor:function(I,G,D,J,F,E){var H=I.replace(/\./,"/");return String.format('<a href="/xwiki/bin/view/{0}">{1}</a>',H,D.data.contributorName)},rating:function(H,G,D,I,F,E){if(H!=""){G.css=String.format("crs-{0}",H);return String.format('<img class="crs-icon" alt="" src="{2}" /><span class="crs-text">{1}</a>',H,_("curriki.crs.rating"+H),Ext.BLANK_IMAGE_URL)}else{return String.format("")}},updated:function(I,G,D,J,F,E){var H=Ext.util.Format.date(I,"M-d-Y");return String.format("{0}",H)}}};Ext.onReady(function(){A.init()})})();(function(){var D="resource";Ext.ns("Curriki.module.search.form."+D);var A=Curriki.module.search;var B=A.form[D];var C=A.data[D];B.init=function(){console.log("form."+D+": init");var F=160;var E=F+17;B.ictCombo=function(G){Ext.apply(this,G)};Ext.extend(B.ictCombo,Ext.util.Observable,{init:function(G){Ext.apply(G,{tpl:'<tpl for="."><div class="x-combo-list-item ict-icon-combo-item ict-{'+G.valueField+'}"><img class="ict-icon" src="'+Ext.BLANK_IMAGE_URL+'"/><span class="ict-title">{'+G.displayField+"}</span></div></tpl>",onRender:G.onRender.createSequence(function(I,H){this.wrap.applyStyles({position:"relative"});this.el.addClass("ict-icon-combo-input");this.icon=Ext.DomHelper.append(this.el.up("div.x-form-field-wrap"),{tag:"div",style:"position:absolute"})}),setIconCls:function(){var H=this.store.query(this.valueField,this.getValue()).itemAt(0);if(H){this.icon.className="ict-icon-combo-icon ict-"+H.get(this.valueField)+" ict-icon"}},setValue:G.setValue.createSequence(function(H){this.setIconCls()})})}});B.termPanel=A.util.createTermPanel(D,B);B.filterPanel={xtype:"form",labelAlign:"left",id:"search-filterPanel-"+D,formId:"search-filterForm-"+D,border:false,items:[B.termPanel,{xtype:"fieldset",title:_("search.advanced.search.button"),id:"search-advanced-"+D,autoHeight:true,collapsible:true,collapsed:true,border:true,stateful:true,stateEvents:["expand","collapse"],listeners:{statesave:{fn:A.util.fieldsetPanelSave},staterestore:{fn:A.util.fieldsetPanelRestore}},items:[{layout:"column",border:false,defaults:{border:false,hideLabel:true},items:[{columnWidth:0.33,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-subject-"+D,fieldLabel:"Subject",hiddenName:"subjectparent",width:F,listWidth:E,mode:"local",store:C.filter.store.subject,displayField:"subject",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.AssetClass_fw_items_FW_masterFramework.UNSPECIFIED"),selectOnFocus:true,forceSelection:true,listeners:{select:{fn:function(I,H){var G=Ext.getCmp("combo-subsubject-"+D);if(I.getValue()===""){G.clearValue();G.hide()}else{G.show();G.clearValue();G.store.filter("parentItem",I.getValue());G.setValue(I.getValue())}}}}},{xtype:"combo",fieldLabel:"Sub Subject",id:"combo-subsubject-"+D,hiddenName:"subject",width:F,listWidth:E,mode:"local",store:C.filter.store.subsubject,displayField:"subject",valueField:"id",typeAhead:true,triggerAction:"all",selectOnFocus:true,forceSelection:true,lastQuery:"",hidden:true,hideMode:"visibility"},{xtype:"combo",id:"combo-review-"+D,fieldLabel:"Review",hiddenName:"review",width:F,listWidth:E,mode:"local",store:C.filter.store.review,displayField:"review",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("search.resource.review.selector.UNSPECIFIED"),selectOnFocus:true,forceSelection:true}]},{columnWidth:0.33,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-level-"+D,fieldLabel:"Level",mode:"local",width:F,listWidth:E,store:C.filter.store.level,hiddenName:"level",displayField:"level",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.AssetClass_educational_level2_UNSPECIFIED"),selectOnFocus:true,forceSelection:true},{xtype:"combo",id:"combo-language-"+D,fieldLabel:"Language",hiddenName:"language",width:F,listWidth:E,mode:"local",store:C.filter.store.language,displayField:"language",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.AssetClass_language_UNSPECIFIED"),selectOnFocus:true,forceSelection:true},{xtype:"combo",id:"combo-special-"+D,fieldLabel:"Special Filters",hiddenName:"special",width:F,listWidth:E,mode:"local",store:C.filter.store.special,displayField:"special",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("search.resource.special.selector.UNSPECIFIED"),selectOnFocus:true,forceSelection:true}]},{columnWidth:0.34,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-ictprfx-"+D,fieldLabel:"Instructional Type",hiddenName:"ictprfx",width:F,listWidth:E,mode:"local",store:C.filter.store.ict,displayField:"ict",valueField:"id",plugins:new B.ictCombo(),typeAhead:true,triggerAction:"all",emptyText:_("XWiki.AssetClass_instructional_component2_UNSPECIFIED"),selectOnFocus:true,forceSelection:true,listeners:{select:{fn:function(J,G){var I=Ext.getCmp("combo-subICT-"+D);if(J.getValue()===""){I.clearValue();I.hide()}else{I.clearValue();I.store.filter("parentICT",J.getValue());var H=I.store.getById(J.getValue()+"*");if(Ext.isEmpty(H)){I.setValue(J.getValue());I.hide()}else{I.setValue(J.getValue()+"*");I.show()}}}}}},{xtype:"combo",fieldLabel:"Sub ICT",hiddenName:"ict",width:F,listWidth:E,id:"combo-subICT-"+D,mode:"local",store:C.filter.store.subict,displayField:"ict",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:"Select a Sub ICT...",selectOnFocus:true,forceSelection:true,lastQuery:"",hidden:true,hideMode:"visibility"}]}]}]}]};B.rowExpander=new Ext.grid.RowExpander({tpl:new Ext.Template("{info}")});B.rowExpander.renderer=function(I,J,H){var G;if(H.data.info!==""){J.cellAttr='rowspan="2"';G="x-grid3-row-expander";return String.format('<img class="{0}" src="{1}" height="18px" width="18px" ext:qtip="{2}" />',G,Ext.BLANK_IMAGE_URL,_("search.resource.icon.plus.rollover"))}else{G="x-grid3-row-expander-empty";return String.format('<img class="{0}" src="{1}" height="18px" width="18px" />',G,Ext.BLANK_IMAGE_URL)}};B.rowExpander.on("expand",function(L,I,H,G){var K=L.grid.view.getRow(G);var J=Ext.DomQuery.selectNode("img[class=x-grid3-row-expander]",K);Ext.fly(J).set({"ext:qtip":_("search.resource.icon.minus.rollover")})});B.rowExpander.on("collapse",function(L,I,H,G){var K=L.grid.view.getRow(G);var J=Ext.DomQuery.selectNode("img[class=x-grid3-row-expander]",K);Ext.fly(J).set({"ext:qtip":_("search.resource.icon.plus.rollover")})});B.columnModel=new Ext.grid.ColumnModel([Ext.apply(B.rowExpander,{tooltip:_("search.resource.icon.plus.title")}),{id:"title",header:_("search.resource.column.header.title"),width:179,dataIndex:"title",sortable:true,hideable:false,renderer:C.renderer.title,tooltip:_("search.resource.column.header.title")},{id:"ict",width:169,header:_("search.resource.column.header.ict"),dataIndex:"ictText",sortable:true,renderer:C.renderer.ict,tooltip:_("search.resource.column.header.ict")},{id:"contributor",width:147,header:_("search.resource.column.header.contributor"),dataIndex:"contributor",sortable:true,renderer:C.renderer.contributor,tooltip:_("search.resource.column.header.contributor")},{id:"rating",width:74,header:_("search.resource.column.header.rating"),dataIndex:"rating",sortable:true,renderer:C.renderer.rating,tooltip:_("search.resource.column.header.rating")},{id:"updated",width:68,header:_("search.resource.column.header.updated"),dataIndex:"updated",hidden:true,sortable:false,renderer:C.renderer.updated,tooltip:_("search.resource.column.header.updated")}]);B.resultsPanel={xtype:"grid",id:"search-results-"+D,border:false,autoHeight:true,autoExpandColumn:"title",frame:false,stripeRows:true,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true},store:C.store.results,sm:new Ext.grid.RowSelectionModel({selectRow:Ext.emptyFn}),cm:B.columnModel,loadMask:false,plugins:B.rowExpander,bbar:new Ext.PagingToolbar({id:"search-pager-"+D,plugins:new Ext.ux.Andrie.pPageSize({variations:[10,25,50]}),pageSize:25,store:C.store.results,displayInfo:true,displayMsg:_("search.pagination.count.displayed"),emptyMsg:_("search.find.no.results"),afterPageText:_("search.pagination.count.total")})};B.mainPanel={xtype:"panel",id:"search-panel-"+D,autoHeight:true,items:[B.filterPanel,B.resultsPanel]};B.doSearch=function(){A.util.doSearch(D)};A.util.registerTabTitleListener(D)};Ext.onReady(function(){B.init()})})();(function(){var B="group";Ext.ns("Curriki.module.search.data."+B);var A=Curriki.module.search.data.group;A.init=function(){console.log("data."+B+": init");A.filter={};var C=A.filter;C.data={};C.data.subject={mapping:Curriki.data.fw_item.fwMap["FW_masterFramework.WebHome"],list:[],data:[["",_("XWiki.CurrikiSpaceClass_topic_FW_masterFramework.WebHome.UNSPECIFIED")]]};C.data.subject.mapping.each(function(D){C.data.subject.list.push(D.id)});C.data.subject.list.each(function(D){C.data.subject.data.push([D,_("XWiki.CurrikiSpaceClass_topic_"+D)])});C.data.subsubject={mapping:Curriki.data.fw_item.fwMap,data:[]};C.data.subject.mapping.each(function(D){C.data.subsubject.data.push([D.id,_("XWiki.CurrikiSpaceClass_topic_"+D.id+".UNSPECIFIED"),D.id]);C.data.subsubject.mapping[D.id].each(function(E){C.data.subsubject.data.push([E.id,_("XWiki.CurrikiSpaceClass_topic_"+E.id),D.id])})});C.data.level={list:Curriki.data.el.list,data:[["",_("XWiki.CurrikiSpaceClass_educationLevel_UNSPECIFIED")]]};C.data.level.list.each(function(D){C.data.level.data.push([D,_("XWiki.CurrikiSpaceClass_educationLevel_"+D)])});C.data.policy={list:["open","closed"],data:[["",_("search.XWiki.SpaceClass_policy_UNSPECIFIED")]]};C.data.policy.list.each(function(D){C.data.policy.data.push([D,_("search.XWiki.SpaceClass_policy_"+D)])});C.data.language={list:Curriki.data.language.list,data:[["",_("XWiki.CurrikiSpaceClass_language_UNSPECIFIED")]]};C.data.language.list.each(function(D){C.data.language.data.push([D,_("XWiki.CurrikiSpaceClass_language_"+D)])});C.store={subject:new Ext.data.SimpleStore({fields:["id","subject"],data:C.data.subject.data,id:0}),subsubject:new Ext.data.SimpleStore({fields:["id","subject","parentItem"],data:C.data.subsubject.data,id:0}),level:new Ext.data.SimpleStore({fields:["id","level"],data:C.data.level.data,id:0}),policy:new Ext.data.SimpleStore({fields:["id","policy"],data:C.data.policy.data,id:0}),language:new Ext.data.SimpleStore({fields:["id","language"],data:C.data.language.data,id:0})};A.store={};A.store.record=new Ext.data.Record.create([{name:"title"},{name:"url"},{name:"policy"},{name:"description"},{name:"updated"}]);A.store.results=new Ext.data.Store({storeId:"search-store-"+B,proxy:new Ext.data.HttpProxy({url:"/xwiki/bin/view/Search/Groups",method:"GET"}),baseParams:{xpage:"plain"},reader:new Ext.data.JsonReader({root:"rows",totalProperty:"resultCount",id:"page"},A.store.record),remoteSort:true});A.store.results.setDefaultSort("title","asc");A.renderer={title:function(H,G,D,I,F,E){return String.format('<a href="{0}">{1}</a>',D.data.url,H)},policy:function(H,G,D,J,F,E){if(H!==""){G.css="policy-"+H}var I=_("search.group.icon."+H);return String.format('<span ext:qtip="{1}">{0}</span>',I,_("search.group.icon."+H+".rollover"))},description:function(H,G,D,J,F,E){var I=Ext.util.Format.htmlDecode(H);I=Ext.util.Format.stripScripts(H);I=Ext.util.Format.stripTags(I);I=Ext.util.Format.ellipsis(I,128);I=Ext.util.Format.htmlEncode(I);I=Ext.util.Format.trim(I);return String.format("{0}",I)},updated:function(I,G,D,J,F,E){var H=Ext.util.Format.date(I,"M-d-Y");return String.format("{0}",H)}}};Ext.onReady(function(){A.init()})})();(function(){var D="group";Ext.ns("Curriki.module.search.form."+D);var A=Curriki.module.search;var B=A.form[D];var C=A.data[D];B.init=function(){console.log("form.group: init");var F=160;var E=F+17;B.termPanel=A.util.createTermPanel(D,B);B.filterPanel={xtype:"form",labelAlign:"top",id:"search-filterPanel-"+D,formId:"search-filterForm-"+D,border:false,items:[B.termPanel,{xtype:"fieldset",title:_("search.advanced.search.button"),autoHeight:true,collapsible:true,collapsed:true,border:true,stateful:true,stateEvents:["expand","collapse"],listeners:{statesave:{fn:A.util.fieldsetPanelSave},staterestore:{fn:A.util.fieldsetPanelRestore}},items:[{layout:"column",border:false,defaults:{border:false,hideLabel:true},items:[{columnWidth:0.33,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",fieldLabel:"Subject",id:"combo-subject-"+D,hiddenName:"subjectparent",width:F,listWidth:E,mode:"local",store:C.filter.store.subject,displayField:"subject",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.CurrikiSpaceClass_topic_FW_masterFramework.WebHome.UNSPECIFIED"),selectOnFocus:true,forceSelection:true,listeners:{select:{fn:function(I,H){var G=Ext.getCmp("combo-subsubject-"+D);if(I.getValue()===""){G.clearValue();G.hide()}else{G.show();G.clearValue();G.store.filter("parentItem",I.getValue());G.setValue(I.getValue())}}}}},{xtype:"combo",fieldLabel:"Sub Subject",id:"combo-subsubject-"+D,hiddenName:"subject",width:F,listWidth:E,mode:"local",store:C.filter.store.subsubject,displayField:"subject",valueField:"id",typeAhead:true,triggerAction:"all",selectOnFocus:true,forceSelection:true,lastQuery:"",hidden:true,hideMode:"visibility"}]},{columnWidth:0.33,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-level-"+D,fieldLabel:"Level",mode:"local",width:F,listWidth:E,store:C.filter.store.level,hiddenName:"level",displayField:"level",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.CurrikiSpaceClass_educationLevel_UNSPECIFIED"),selectOnFocus:true,forceSelection:true},{xtype:"combo",id:"combo-language-"+D,fieldLabel:"Language",hiddenName:"language",mode:"local",width:F,listWidth:E,store:C.filter.store.language,displayField:"language",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.CurrikiSpaceClass_language_UNSPECIFIED"),selectOnFocus:true,forceSelection:true}]},{columnWidth:0.34,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-policy-"+D,fieldLabel:"Membership Policy",hiddenName:"policy",mode:"local",width:F,listWidth:E,store:C.filter.store.policy,displayField:"policy",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("search.XWiki.SpaceClass_policy_UNSPECIFIED"),selectOnFocus:true,forceSelection:true}]}]}]}]};B.columnModel=new Ext.grid.ColumnModel([{id:"policy",header:"",dataIndex:"policy",sortable:true,resizable:false,menuDisabled:true,renderer:C.renderer.policy},{id:"title",header:_("search.group.column.header.name"),dataIndex:"title",sortable:true,hideable:false,renderer:C.renderer.title,tooltip:_("search.group.column.header.name")},{id:"description",header:_("search.group.column.header.description"),dataIndex:"description",sortable:false,renderer:C.renderer.description,tooltip:_("search.group.column.header.description")},{id:"updated",header:_("search.group.column.header.updated"),dataIndex:"updated",sortable:true,renderer:C.renderer.updated,tooltip:_("search.group.column.header.updated")}]);B.resultsPanel={xtype:"grid",id:"search-results-"+D,border:false,autoHeight:true,autoExpandColumn:"description",frame:false,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true},store:C.store.results,sm:new Ext.grid.RowSelectionModel({selectRow:Ext.emptyFn}),cm:B.columnModel,loadMask:false,plugins:B.rowExpander,bbar:new Ext.PagingToolbar({id:"search-pager-"+D,plugins:new Ext.ux.Andrie.pPageSize({variations:[10,25,50]}),pageSize:25,store:C.store.results,displayInfo:true,displayMsg:_("search.pagination.count.displayed"),emptyMsg:_("search.find.no.results"),afterPageText:_("search.pagination.count.total")})};B.mainPanel={xtype:"panel",id:"search-panel-"+D,items:[B.filterPanel,B.resultsPanel]};B.doSearch=function(){A.util.doSearch(D)};A.util.registerTabTitleListener(D)};Ext.onReady(function(){B.init()})})();(function(){var B="member";Ext.ns("Curriki.module.search.data."+B);var A=Curriki.module.search.data.member;A.init=function(){console.log("data."+B+": init");A.filter={};var C=A.filter;C.data={};C.data.subject={mapping:Curriki.data.fw_item.fwMap["FW_masterFramework.WebHome"],list:[],data:[["",_("XWiki.XWikiUsers_topics_FW_masterFramework.WebHome.UNSPECIFIED")]]};C.data.subject.mapping.each(function(D){C.data.subject.list.push(D.id)});C.data.subject.list.each(function(D){C.data.subject.data.push([D,_("XWiki.XWikiUsers_topics_"+D)])});C.data.subsubject={mapping:Curriki.data.fw_item.fwMap,data:[]};C.data.subject.mapping.each(function(D){C.data.subsubject.data.push([D.id,_("XWiki.XWikiUsers_topics_"+D.id+".UNSPECIFIED"),D.id]);C.data.subsubject.mapping[D.id].each(function(E){C.data.subsubject.data.push([E.id,_("XWiki.XWikiUsers_topics_"+E.id),D.id])})});C.data.country={list:"AD|AE|AF|AG|AI|AL|AM|AN|AO|AQ|AR|AS|AT|AU|AW|AX|AZ|BA|BB|BD|BE|BF|BG|BH|BI|BJ|BM|BN|BO|BR|BS|BT|BV|BW|BY|BZ|CA|CC|CD|CF|CG|CH|CI|CK|CL|CM|CN|CO|CR|CU|CV|CX|CY|CZ|DE|DJ|DK|DM|DO|DZ|EC|EE|EG|EH|ER|ES|ET|FI|FJ|FK|FM|FO|FR|GA|GB|GD|GE|GF|GG|GH|GI|GL|GM|GN|GP|GQ|GR|GS|GT|GU|GW|GY|HK|HM|HN|HR|HT|HU|ID|IE|IL|IM|IN|IO|IQ|IR|IS|IT|JE|JM|JO|JP|KE|KG|KH|KI|KM|KN|KP|KR|KW|KY|KZ|LA|LB|LC|LI|LK|LR|LS|LT|LU|LV|LY|MA|MC|MD|ME|MG|MH|MK|ML|MM|MN|MO|MP|MQ|MR|MS|MT|MU|MV|MW|MX|MY|MZ|NA|NC|NE|NF|NG|NI|NL|NO|NP|NR|NU|NZ|OM|PA|PE|PF|PG|PH|PK|PL|PM|PN|PR|PS|PT|PW|PY|QA|RE|RO|RS|RU|RW|SA|SB|SC|SD|SE|SG|SH|SI|SJ|SK|SL|SM|SN|SO|SR|ST|SV|SY|SZ|TC|TD|TF|TG|TH|TJ|TK|TL|TM|TN|TO|TR|TT|TV|TW|TZ|UA|UG|UM|US|UY|UZ|VA|VC|VE|VG|VI|VN|VU|WF|WS|YE|YT|ZA|ZM|ZW".split("|"),data:[["",_("XWiki.XWikiUsers_country_UNSPECIFIED")]]};C.data.country.list.each(function(D){C.data.country.data.push([D,_("XWiki.XWikiUsers_country_"+D)])});C.data.member_type={list:["parent","teacher","professional","student"],data:[["",_("XWiki.XWikiUsers_member_type_UNSPECIFIED")]]};C.data.member_type.list.each(function(D){C.data.member_type.data.push([D,_("XWiki.XWikiUsers_member_type_"+D)])});C.store={subject:new Ext.data.SimpleStore({fields:["id","subject"],data:C.data.subject.data,id:0}),subsubject:new Ext.data.SimpleStore({fields:["id","subject","parentItem"],data:C.data.subsubject.data,id:0}),member_type:new Ext.data.SimpleStore({fields:["id","member_type"],data:C.data.member_type.data,id:0}),country:new Ext.data.SimpleStore({fields:["id","country"],data:C.data.country.data,id:0})};A.store={};A.store.record=new Ext.data.Record.create([{name:"name1"},{name:"name2"},{name:"url"},{name:"bio"},{name:"picture"},{name:"contributions"}]);A.store.results=new Ext.data.Store({storeId:"search-store-"+B,proxy:new Ext.data.HttpProxy({url:"/xwiki/bin/view/Search/Members",method:"GET"}),baseParams:{xpage:"plain"},reader:new Ext.data.JsonReader({root:"rows",totalProperty:"resultCount",id:"page"},A.store.record),remoteSort:true});A.store.results.setDefaultSort("name1","asc");A.renderer={name1:function(H,G,D,I,F,E){return String.format('<a href="{1}">{0}</a>',H,D.data.url)},name2:function(H,G,D,I,F,E){return String.format('<a href="{1}">{0}</a>',H,D.data.url)},picture:function(H,G,D,I,F,E){return String.format('<a href="{2}"><img src="{0}" alt="{1}" class="member-picture" style="width:88px" /></a>',H,_("search.member.column.picture.alt.text"),D.data.url)},contributions:function(H,G,D,I,F,E){return String.format("{0}",H)},bio:function(H,G,D,J,F,E){var I=Ext.util.Format.htmlDecode(H);I=Ext.util.Format.stripScripts(H);I=Ext.util.Format.stripTags(I);I=Ext.util.Format.ellipsis(I,128);I=Ext.util.Format.htmlEncode(I);I=Ext.util.Format.trim(I);return String.format("{0}",I)}}};Ext.onReady(function(){A.init()})})();(function(){var D="member";Ext.ns("Curriki.module.search.form."+D);var A=Curriki.module.search;var B=A.form[D];var C=A.data[D];B.init=function(){console.log("form.member: init");var F=160;var E=F+17;B.termPanel=A.util.createTermPanel(D,B);B.filterPanel={xtype:"form",labelAlign:"top",id:"search-filterPanel-"+D,formId:"search-filterForm-"+D,border:false,items:[B.termPanel,{xtype:"fieldset",title:_("search.advanced.search.button"),autoHeight:true,collapsible:true,collapsed:true,border:true,stateful:true,stateEvents:["expand","collapse"],listeners:{statesave:{fn:A.util.fieldsetPanelSave},staterestore:{fn:A.util.fieldsetPanelRestore}},items:[{layout:"column",border:false,defaults:{border:false,hideLabel:true},items:[{columnWidth:0.33,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-subject-"+D,fieldLabel:"Subject",hiddenName:"subjectparent",width:F,listWidth:E,mode:"local",store:C.filter.store.subject,displayField:"subject",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.XWikiUsers_topics_FW_masterFramework.WebHome.UNSPECIFIED"),selectOnFocus:true,forceSelection:true,listeners:{select:{fn:function(I,H){var G=Ext.getCmp("combo-subsubject-"+D);if(I.getValue()===""){G.clearValue();G.hide()}else{G.show();G.clearValue();G.store.filter("parentItem",I.getValue());G.setValue(I.getValue())}}}}},{xtype:"combo",fieldLabel:"Sub Subject",id:"combo-subsubject-"+D,hiddenName:"subject",width:F,listWidth:E,mode:"local",store:C.filter.store.subsubject,displayField:"subject",valueField:"id",typeAhead:true,triggerAction:"all",selectOnFocus:true,forceSelection:true,lastQuery:"",hidden:true,hideMode:"visibility"}]},{columnWidth:0.33,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-member_type-"+D,fieldLabel:"Member Type",mode:"local",width:F,listWidth:E,store:C.filter.store.member_type,hiddenName:"member_type",displayField:"member_type",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.XWikiUsers_member_type_UNSPECIFIED"),selectOnFocus:true,forceSelection:true}]},{columnWidth:0.34,layout:"form",defaults:{hideLabel:true},items:[{xtype:"combo",id:"combo-country-"+D,fieldLabel:"Country",hiddenName:"country",width:F,listWidth:E,mode:"local",store:C.filter.store.country,displayField:"country",valueField:"id",typeAhead:true,triggerAction:"all",emptyText:_("XWiki.XWikiUsers_country_UNSPECIFIED"),selectOnFocus:true,forceSelection:true}]}]}]}]};B.columnModelList=[{id:"picture",header:"",width:98,dataIndex:"picture",sortable:false,resizable:false,menuDisabled:true,renderer:C.renderer.picture},{id:"name1",header:_("search.member.column.header.name1"),dataIndex:"name1",sortable:true,hideable:false,renderer:C.renderer.name1,tooltip:_("search.member.column.header.name1")},{id:"name2",header:_("search.member.column.header.name2"),dataIndex:"name2",sortable:true,hideable:false,renderer:C.renderer.name2,tooltip:_("search.member.column.header.name2")},{id:"bio",header:_("search.member.column.header.bio"),dataIndex:"bio",sortable:false,renderer:C.renderer.bio,tooltip:_("search.member.column.header.bio")},{id:"contributions",header:_("search.member.column.header.contributions"),dataIndex:"contributions",sortable:false,renderer:C.renderer.contributions,tooltip:_("search.member.column.header.contributions")}];B.columnModel=new Ext.grid.ColumnModel(B.columnModelList);B.resultsPanel={xtype:"grid",id:"search-results-"+D,border:false,autoHeight:true,autoExpandColumn:"bio",frame:false,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true},store:C.store.results,sm:new Ext.grid.RowSelectionModel({selectRow:Ext.emptyFn}),cm:B.columnModel,loadMask:false,plugins:B.rowExpander,bbar:new Ext.PagingToolbar({id:"search-pager-"+D,plugins:new Ext.ux.Andrie.pPageSize({variations:[10,25,50]}),pageSize:25,store:C.store.results,displayInfo:true,displayMsg:_("search.pagination.count.displayed"),emptyMsg:_("search.find.no.results"),afterPageText:_("search.pagination.count.total")})};B.mainPanel={xtype:"panel",id:"search-panel-"+D,items:[B.filterPanel,B.resultsPanel]};B.doSearch=function(){A.util.doSearch(D)};A.util.registerTabTitleListener(D)};Ext.onReady(function(){B.init()})})();(function(){var B="blog";Ext.ns("Curriki.module.search.data."+B);var A=Curriki.module.search.data.blog;A.init=function(){console.log("data."+B+": init");A.store={};A.store.record=new Ext.data.Record.create([{name:"name"},{name:"title"},{name:"text"},{name:"comments"},{name:"updated"},{name:"memberUrl"},{name:"blogUrl"}]);A.store.results=new Ext.data.Store({storeId:"search-store-"+B,proxy:new Ext.data.HttpProxy({url:"/xwiki/bin/view/Search/Blogs",method:"GET"}),baseParams:{xpage:"plain"},reader:new Ext.data.JsonReader({root:"rows",totalProperty:"resultCount",id:"page"},A.store.record),remoteSort:true});A.store.results.setDefaultSort("name","asc");A.renderer={name:function(G,F,C,H,E,D){return String.format('<a href="{1}">{0}</a>',G,C.data.memberUrl)},text:function(G,F,C,I,E,D){var H=Ext.util.Format.htmlDecode(G);H=Ext.util.Format.stripScripts(G);H=Ext.util.Format.stripTags(H);H=Ext.util.Format.ellipsis(H,128);H=Ext.util.Format.htmlEncode(H);H=Ext.util.Format.trim(H);return String.format('<a href="{2}" class="search-blog-title">{1}</a><br /><br />{0}',H,C.data.title,C.data.blogUrl)},comments:function(G,F,C,H,E,D){return String.format("{0}",G)},updated:function(H,F,C,I,E,D){var G=Ext.util.Format.date(H,"M-d-Y");return String.format("{0}",G)}}};Ext.onReady(function(){A.init()})})();(function(){var D="blog";Ext.ns("Curriki.module.search.form."+D);var A=Curriki.module.search;var B=A.form[D];var C=A.data[D];B.init=function(){console.log("form."+D+": init");B.termPanel=A.util.createTermPanel(D,B);B.filterPanel={xtype:"form",labelAlign:"left",id:"search-filterPanel-"+D,formId:"search-filterForm-"+D,border:false,items:[B.termPanel]};B.columnModel=new Ext.grid.ColumnModel([{id:"name",header:_("search.blog.column.header.name"),dataIndex:"name",renderer:C.renderer.name,tooltip:_("search.blog.column.header.name")},{id:"text",header:_("search.blog.column.header.text"),dataIndex:"text",sortable:false,renderer:C.renderer.text,tooltip:_("search.blog.column.header.text")},{id:"comments",header:_("search.blog.column.header.comments"),width:56,dataIndex:"comments",sortable:false,renderer:C.renderer.comments,tooltip:_("search.blog.column.header.comments")},{id:"updated",width:71,header:_("search.blog.column.header.updated"),dataIndex:"updated",sortable:true,renderer:C.renderer.updated,tooltip:_("search.blog.column.header.updated")}]);B.resultsPanel={xtype:"grid",id:"search-results-"+D,border:false,autoHeight:true,autoExpandColumn:"text",frame:false,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true},store:C.store.results,sm:new Ext.grid.RowSelectionModel({selectRow:Ext.emptyFn}),cm:B.columnModel,loadMask:false,bbar:new Ext.PagingToolbar({id:"search-pager-"+D,plugins:new Ext.ux.Andrie.pPageSize({variations:[10,25,50]}),pageSize:25,store:C.store.results,displayInfo:true,displayMsg:_("search.pagination.count.displayed"),emptyMsg:_("search.find.no.results"),afterPageText:_("search.pagination.count.total")})};B.mainPanel={xtype:"panel",id:"search-panel-"+D,items:[B.filterPanel,B.resultsPanel]};B.doSearch=function(){A.util.doSearch(D)};A.util.registerTabTitleListener(D)};Ext.onReady(function(){B.init()})})();(function(){var B="curriki";Ext.ns("Curriki.module.search.data."+B);var A=Curriki.module.search.data.curriki;A.init=function(){console.log("data."+B+": init");A.store={};A.store.record=new Ext.data.Record.create([{name:"name"},{name:"updated"},{name:"url"}]);A.store.results=new Ext.data.Store({storeId:"search-store-"+B,proxy:new Ext.data.HttpProxy({url:"/xwiki/bin/view/Search/Curriki",method:"GET"}),baseParams:{xpage:"plain"},reader:new Ext.data.JsonReader({root:"rows",totalProperty:"resultCount"},A.store.record),remoteSort:true});A.store.results.setDefaultSort("name","asc");A.renderer={name:function(G,F,C,H,E,D){return String.format('<a href="{1}">{0}</a>',G,C.data.url)},updated:function(H,F,C,I,E,D){var G=Ext.util.Format.date(H,"M-d-Y");return String.format("{0}",G)}}};Ext.onReady(function(){A.init()})})();(function(){var D="curriki";Ext.ns("Curriki.module.search.form."+D);var A=Curriki.module.search;var B=A.form[D];var C=A.data[D];B.init=function(){console.log("form."+D+": init");B.termPanel=A.util.createTermPanel(D,B);B.filterPanel={xtype:"form",labelAlign:"left",id:"search-filterPanel-"+D,formId:"search-filterForm-"+D,border:false,items:[B.termPanel]};B.columnModel=new Ext.grid.ColumnModel([{id:"name",header:_("search.curriki.column.header.name"),dataIndex:"name",renderer:C.renderer.name,tooltip:_("search.curriki.column.header.name")},{id:"updated",header:_("search.curriki.column.header.updated"),dataIndex:"updated",sortable:true,renderer:C.renderer.updated,tooltip:_("search.curriki.column.header.updated")}]);B.resultsPanel={xtype:"grid",id:"search-results-"+D,border:false,autoHeight:true,autoExpandColumn:"name",frame:false,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true},store:C.store.results,sm:new Ext.grid.RowSelectionModel({selectRow:Ext.emptyFn}),cm:B.columnModel,loadMask:false,bbar:new Ext.PagingToolbar({id:"search-pager-"+D,plugins:new Ext.ux.Andrie.pPageSize({variations:[10,25,50]}),pageSize:25,store:C.store.results,displayInfo:true,displayMsg:_("search.pagination.count.displayed"),emptyMsg:_("search.find.no.results"),afterPageText:_("search.pagination.count.total")})};B.mainPanel={xtype:"panel",id:"search-panel-"+D,items:[B.filterPanel,B.resultsPanel]};B.doSearch=function(){A.util.doSearch(D)};A.util.registerTabTitleListener(D)};Ext.onReady(function(){B.init()})})();(function(){Ext.ns("Curriki.module.search.form");var B=Curriki.module.search;var A=B.form;B.init=function(){console.log("search: init");if(Ext.isEmpty(B.initialized)){B.ignoreNextHistoryChange=false;B.ignoreNextSearchForHistory=false;if(Ext.isEmpty(B.tabList)){B.tabList=["resource","group","member","blog","curriki"]}B.doSearch=function(H){var F={};var D={};var E={};Ext.each(B.tabList,function(M){var L=A[M];if(!Ext.isEmpty(L)&&!Ext.isEmpty(L.doSearch)){var K=Ext.getCmp("search-filterPanel-"+M);if(!Ext.isEmpty(K)){var N=K.getForm();if(!Ext.isEmpty(N)){F[M]=N.getValues(false)}}var I=Ext.getCmp("search-advanced-"+M);if(!Ext.isEmpty(I)){if(!I.collapsed){E[M]={a:true}}}var J=Ext.getCmp("search-pager-"+M);if(!Ext.isEmpty(J)){var O={};O.c=0;O.s=J.pageSize;D[M]=O}if(Ext.isEmpty(H)||H===M){L.doSearch()}}});if(!B.ignoreNextSearchForHistory){var C={};C.s=Ext.isEmpty(H)?"all":H;C.f=F;C.p=D;if(Ext.getCmp("search-tabPanel").getActiveTab){C.t=Ext.getCmp("search-tabPanel").getActiveTab().id}C.a=E;var G=new Ext.state.Provider();B.ignoreNextHistoryChange=true;console.log("Saving History",{values:C});Ext.History.add(G.encodeValue(C))}else{B.ignoreNextSearchForHistory=false}};B.tabPanel={xtype:(B.tabList.size()>1?"tab":"")+"panel",id:"search-tabPanel",activeTab:0,deferredRender:false,autoHeight:true,layoutOnTabChange:true,frame:false,border:false,plain:true,defaults:{autoScroll:false,border:false},listeners:{},items:[]};Ext.each(B.tabList,function(C){panel={title:_("search."+C+".tab.title"),id:"search-"+C+"-tab",autoHeight:true};module=A[C];if(!Ext.isEmpty(module)&&!Ext.isEmpty(module.mainPanel)){panel.items=[module.mainPanel];B.tabPanel.items.push(panel)}});B.mainPanel={el:"search-div",border:false,height:"600px",defaults:{border:false},items:[B.tabPanel]};B.initialized=true;console.log("search: init done")}};B.history=function(){if(!Ext.isEmpty(Ext.History)){B.historyChange=function(F){if(!B.ignoreNextHistoryChange){if(F){var J=new Ext.state.Provider();var D=J.decodeValue(F);console.log("Got History",{token:F,values:D});var I=D.f;var G=D.p;var H=D.a;Ext.each(B.tabList,function(O){console.log("Updating "+O);var N=B.form[O];if(!Ext.isEmpty(N)&&!Ext.isEmpty(N.doSearch)&&!Ext.isEmpty(I)&&!Ext.isEmpty(I[O])){var M=Ext.getCmp("search-filterPanel-"+O);if(!Ext.isEmpty(M)){var Q=M.getForm();if(!Ext.isEmpty(Q)){try{Q.setValues(I[O]);var P=Ext.getCmp("combo-subject-"+O);if(P){P.fireEvent("select",P,P.getValue());if(!Ext.isEmpty(I[O].subject)){if(Ext.getCmp("combo-subsubject-"+O)){Ext.getCmp("combo-subsubject-"+O).setValue(I[O].subject)}}}P=Ext.getCmp("combo-ictprfx-"+O);if(P){P.fireEvent("select",P,P.getValue());if(!Ext.isEmpty(I[O].ict)){if(Ext.getCmp("combo-subICT-"+O)){Ext.getCmp("combo-subICT-"+O).setValue(I[O].ict)}}}}catch(R){console.log("ERROR Updating "+O,R)}}}if(!Ext.isEmpty(H)&&!Ext.isEmpty(H[O])&&!Ext.isEmpty(H[O].a)){var L=Ext.getCmp("search-advanced-"+O);if(!Ext.isEmpty(L)){L.expand(false)}}var K=Ext.getCmp("search-pager-"+O);if(!Ext.isEmpty(K)&&!Ext.isEmpty(G)){if(G[O]){try{if(G[O]["c"]){K.cursor=G[O]["c"]}if(G[O]["s"]){if(K.pageSize!=G[O]["s"]){K.setPageSize(G[O]["s"])}}}catch(R){console.log("ERROR Updating "+O,R)}}}}});if(D.t){if(Ext.getCmp("search-tabPanel").setActiveTab){Ext.getCmp("search-tabPanel").setActiveTab(D.t)}}if(D.s){console.log("Starting search");B.ignoreNextSearchForHistory=true;if(D.s==="all"){B.doSearch()}else{var E=B.form[D.s];if(!Ext.isEmpty(E)&&!Ext.isEmpty(E.doSearch)){E.doSearch()}}}}else{}}else{B.ignoreNextHistoryChange=false}};var C=Ext.History.getToken();Ext.History.init(function(){Ext.History.on("change",B.historyChange);if(C){B.historyChange(C)}})}};B.display=function(){Ext.QuickTips.init();B.init();var C=new Ext.Panel(B.mainPanel);C.render();B.history()};B.start=function(){Ext.onReady(function(){B.display()})}})();