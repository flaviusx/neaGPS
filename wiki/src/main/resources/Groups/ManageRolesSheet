<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc>
<web>Groups</web>
<name>ManageRolesSheet</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent></parent>
<creator>XWiki.dward</creator>
<author>XWiki.LudovicDubost</author>
<customClass></customClass>
<contentAuthor>XWiki.LudovicDubost</contentAuthor>
<creationDate>1202239285000</creationDate>
<date>1219967925000</date>
<contentUpdateDate>1219967925000</contentUpdateDate>
<version>8.1</version>
<title>Manage Roles</title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment>Fix macro names</comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/1.0</syntaxId>
<object>
<class>
<name>XWiki.TagClass</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<tags>
<cache>0</cache>
<displayType>select</displayType>
<multiSelect>1</multiSelect>
<name>tags</name>
<number>1</number>
<prettyName>Tags</prettyName>
<relationalStorage>1</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>30</size>
<unmodifiable>0</unmodifiable>
<values></values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</tags>
</class>
<name>Groups.ManageRolesSheet</name>
<number>0</number>
<className>XWiki.TagClass</className>
<property>
<tags/>
</property>
</object>
<content>#includeMacros("Groups.Macros")
##
## macros
##
#macro(editRoleLine $role) ## {
  &lt;div id="groups-manage-role-line-${role.name}"&gt;
&lt;div class="lefttext"&gt;
&lt;div class="righttext floatright hidebuttons"&gt;
&lt;a href="javascript:void()" onclick="{pre}$('groups-manage-role-line-{/pre}${role.name}{pre}').hide(); $('groups-manage-roles-edit-{/pre}${role.name}{pre}').show(); $$('.hidebuttons').invoke('hide'); return false;{/pre}"&gt;$msg.get("groups.roles.manage.edit")&lt;/a&gt;
#sep()
&lt;a href="$xwiki.getURL("${spaceName}.ManageRoles", "view", "delete=${role.name}")" onclick="return confirm('$msg.get("groups.roles.manage.delete.confirm")');"&gt;$msg.get("groups.roles.manage.delete")&lt;/a&gt;
&lt;/div&gt;
$role.title
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="groups-manage-roles-edit-${role.name}" style="display:none;" class="frame-inset"&gt;
&lt;form method="post"&gt;
&lt;input name="rename" type="hidden" value="${role.name}" /&gt;
&lt;input name="to" type="text" size=32 maxlength=32 value="${role.title.replace('"', '\"')}" /&gt;
&lt;input class="button button-grey" type="submit" value="$msg.get("groups.roles.manage.cancel")" onclick="document.location.href='$xwiki.getURL("${spaceName}.ManageRoles", "view")'; return false;" /&gt;
&lt;input type="submit" class="button button-orange" value="$msg.get("groups.roles.manage.save")" /&gt;
&lt;/form&gt;
&lt;/div&gt;
#end ## }
##
##
## Start page
#groupinit()
##
#if(!$isGroupAdmin &amp;&amp; !$hasGlobalAdmin) ## {
$msg.get("groups_admins_onlyaccessibletoadmins")
#else ## }{
##
## Create, Rename, Delete roles
##
#if($!request.create) ## {
  #createGroupRole($spaceName $request.create)
#elseif($!request.rename &amp;&amp; $!request.to) ## } {
  #set($roleDoc = $xwiki.getDocument("${spaceName}.${request.rename}"))
  #if($roleDoc.name.startsWith("Role_") &amp;&amp; $roleDoc.name.endsWith("Group")) ## {
    #renameGroupRole($roleDoc $request.to)
  #end ## }
#elseif($!request.delete) ## } {
  #set($roleDoc = $xwiki.getDocument("${spaceName}.${request.delete}"))
  #if($roleDoc.name.startsWith("Role_") &amp;&amp; $roleDoc.name.endsWith("Group")) ## {
    #deleteGroupRole($roleDoc)
  #end ## }
#end ## }
##
## Main page
##
#groupsheader("members")
## List current roles with Edit/Delete
&lt;div id="groups-main-content" class="frame"&gt;
#mycurriki_titlebar($msg.get("groups.roles.manage.titlebar") "" "" "blue")
&lt;div id="groups-main-content-frame" class="frame-content"&gt;
$msg.get("groups.roles.manage.intro")
&lt;br /&gt;
#if($!ret_err) ## {
&lt;div id="groups-manage-roles-error" class="errormessage"&gt;$ret_err &lt;br /&gt;&lt;/div&gt;
#end ## }
#if($!ret_success) ## {
&lt;div id="groups-manage-roles-error" class="infomessage"&gt;$ret_success &lt;br /&gt;&lt;/div&gt;
#end ## }
#groupGetRoles($spaceName false)
#foreach($role in $ret_groupRoles) ## {
  #editRoleLine($role)
#end ## }
## Add role Button
&lt;div id="groups-manage-roles-add-button" class="lefttext"&gt;
&lt;div class="righttext floatright hidebuttons"&gt;&lt;button type="button" class="button button-orange" onclick="{pre}$('groups-manage-roles-add-form').show(); $$('.hidebuttons').invoke('hide');{/pre}"&gt;$msg.get("groups.roles.manage.add")&lt;/button&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id="groups-manage-roles-add-form" style="display:none;" class="frame-inset"&gt;
&lt;form method="post"&gt;
&lt;input name="create" type="text" size=32 maxlength=32 /&gt;
&lt;input class="button button-grey" type="submit" value="$msg.get("groups.roles.manage.cancel")" onclick="document.location.href='$xwiki.getURL("${spaceName}.ManageRoles", "view")'; return false;" /&gt;
&lt;input type="submit" class="button button-orange" value="$msg.get("groups.roles.manage.save")" /&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
## Back to Members
&lt;div id="groups-manage-roles-return" class="centertext"&gt;&lt;a href="/xwiki/bin/view/${spaceName}/Members"&gt;$msg.get("groups.roles.manage.returnlink")&lt;/a&gt;&lt;/div&gt;
#groupsfooter()
#end ## }</content>
</xwikidoc>
