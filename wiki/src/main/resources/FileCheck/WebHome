<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc>
<web>FileCheck</web>
<name>WebHome</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent></parent>
<creator>XWiki.LudovicDubost</creator>
<author>XWiki.ShermanTank</author>
<customClass></customClass>
<contentAuthor>XWiki.ShermanTank</contentAuthor>
<creationDate>1194209149000</creationDate>
<date>1194906144000</date>
<contentUpdateDate>1194906144000</contentUpdateDate>
<version>1.54</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment>Testing exclusion list.</comment>
<object>
<class>
<name>XWiki.TagClass</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<tags>
<cache>0</cache>
<displayType>select</displayType>
<multiSelect>1</multiSelect>
<name>tags</name>
<number>1</number>
<prettyName>Tags</prettyName>
<relationalStorage>1</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>30</size>
<unmodifiable>0</unmodifiable>
<values></values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</tags>
</class>
<name>FileCheck.WebHome</name>
<number>0</number>
<className>XWiki.TagClass</className>
<property>
<tags/>
</property>
</object>
<content>1 $msg.fc_filecheck
#set($excludeList = [ "jmarks", "LudovicDubost"])
#if($request.nbstart)
#set($inbstart = $xwiki.parseInt($request.nbstart))
#else
#set($inbstart = 0)
#end
#set($qs = "type=$!request.type")
#set($inbitems = 20)
#set($counter = 0)
#set($fromsql = "")
#set($wheresql = "and doc.creator not in (")
#foreach($user in $excludeList)
#if($velocityCount&gt;1)
#set($wheresql = "$wheresql ,")
#end
#set($wheresql = "$wheresql 'XWiki.${user}'")
#end
#set($wheresql = "$wheresql )")
#if($request.from&amp;&amp;($request.from!="")&amp;&amp;($request.from!="YYYY/MM/DD"))
#set($wheresql = "$wheresql and doc.date&gt;'$request.from'")
#set($from = $request.from)
#set($qs = "${qs}&amp;from=$from")
#else
#set($from = "YYYY/MM/DD")
#end
#if($request.to&amp;&amp;($request.to!=""))
#set($wheresql = "$wheresql and doc.date&lt;'$request.to'")
#set($qs = "${qs}&amp;to=$to")
#end
#if($request.type=="1")
#set($wheresql = "$wheresql and obj.id not in (select obj2.id from BaseObject as obj2, StringProperty as sprop2 where obj2.className='XWiki.AssetClass' and obj2.id=sprop2.id.id and sprop2.id.name='fcstatus' and sprop2.value is not null)")
#elseif($request.type=="2")
#set($fromsql = "$fromsql ,StringProperty as sprop")
#set($wheresql = "$wheresql and obj.id=sprop.id.id and sprop.id.name='fcstatus' and sprop.value is not null and sprop.value &lt;&gt; '0'")
#elseif($request.type=="3")
#set($wheresql = "$wheresql and (doc.version='1.0' or doc.version='1.1' or doc.version='1.2')")
#end
#if($request.order=="fcstatus")
#if($request.type!="2")
#set($fromsql = "$fromsql ,StringProperty as sprop")
#set($wheresql = "$wheresql and obj.id=sprop.id.id and sprop.id.name='fcstatus'")
#end
#set($order = "sprop.value asc")
#elseif($request.order=="fcdate")
#set($fromsql = "$fromsql ,DateProperty as dprop")
#set($wheresql = "$wheresql and obj.id=dprop.id.id and dprop.id.name='fcdate'")
#set($order = "dprop.value asc")
#else
#set($order = "doc.date desc")
#end
#set($sql = ", BaseObject as obj $!fromsql where doc.web like 'Coll_%'  and doc.fullName=obj.name and obj.className='XWiki.AssetClass' $!wheresql order by $order")
#set($countsql = "select count(*) from XWikiDocument as doc ${sql}")
#set($totalnb = $xwiki.search($countsql))
&lt;!-- $sql --&gt;
&lt;form action=""&gt;
1.1 $msg.fc_daterange

$msg.fc_showresourcesfrom &lt;input type="text" style="width: auto;" name="from" value="$!from" size="12" /&gt; $msg.fc_to &lt;input type="text" style="width: auto;" name="to" value="$!request.to" size="12" /&gt;

1.1 $msg.fc_filterby

&lt;input type="radio" name="type" value="0" #if(!$request.type||($request.type=="0")) checked #end /&gt; $msg.fc_all &lt;br /&gt;
&lt;input type="radio" name="type" value="1" #if($request.type=="1") checked #end /&gt; $msg.fc_onlywithoutfcstatus &lt;br /&gt;
&lt;input type="radio" name="type" value="2" #if($request.type=="2") checked #end /&gt; $msg.fc_onlywithfcstatus &lt;br /&gt;
&lt;input type="radio" name="type" value="3" #if($request.type=="3") checked #end /&gt; $msg.fc_onlyincompleteassets &lt;br /&gt;
&lt;br /&gt;
&lt;input type="submit" value="$msg.fc_ok" /&gt;
&lt;/form&gt;

&lt;table class="filechecktable"&gt;
&lt;tr&gt;
&lt;th&gt; $msg.fc_resourcetitle &lt;/td&gt;
&lt;th&gt; $msg.fc_dateadded &lt;/td&gt;
&lt;th&gt; $msg.fc_contributor &lt;/td&gt;
&lt;th&gt; [$msg.fc_status&gt;$doc.fullName?$qs&amp;order=fcstatus] &lt;/td&gt;
&lt;th&gt; [$msg.fc_datechecked&gt;$doc.fullName?$qs&amp;order=fcdate] &lt;/td&gt;
&lt;th&gt; $msg.fc_notes &lt;/td&gt;
&lt;th&gt; $msg.fc_select &lt;/td&gt;
&lt;/tr&gt;
#foreach($fullname in $xwiki.searchDocuments($sql,$inbitems,$inbstart))
#set($counter = $counter+1)
#set($itemdoc = $xwiki.getDocument($fullname))
#set($ok = $itemdoc.use("XWiki.AssetClass"))
#findCurrikiTitle($itemdoc)
&lt;tr&gt;
&lt;td&gt;&lt;div class="title"&gt;
[$currikiTitle&gt;$fullname]
&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;&lt;div class="date"&gt;
$itemdoc.date
&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;&lt;div class="username"&gt;
$xwiki.getLocalUserName($itemdoc.creator)
&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;&lt;div class="fcstatus"&gt;
$itemdoc.display("fcstatus")
&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;&lt;div class="fcdate"&gt;
$itemdoc.display("fcdate")
&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;&lt;div class="fcnotes"&gt;
$itemdoc.display("fcnotes")
&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;&lt;div class="action"&gt;
#set($qs = $xwiki.getURLEncoded($fullname))
[${msg.fc_action}&gt;Check?page=$qs]
&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
#end
&lt;/table&gt;

#if($counter==$inbitems)
&lt;div style="text-align:center; margin-top:10px;"&gt;
#if ($inbstart!=0)
#set($iprev = $inbstart - $inbitems)
&lt;span class="search searchprevious"&gt;[$msg.fc_previous&gt;$doc.name?nbstart=${iprev}]&lt;/span&gt;
#end
#set($istart = $inbstart + 1)
#set($inext = $inbstart + $inbitems)
#set($stotalnb = "$totalnb")
#set($stotalnb = $stotalnb.replace('[',' ').replace(']',' '))
&lt;span class="search searchcount"&gt;
{pre} $istart - $inext $msg.of $stotalnb {/pre}
&lt;/span&gt;
&lt;span class="search searchnext"&gt;[$msg.fc_next&gt;$doc.name?nbstart=${inext}]&lt;/span&gt;
&lt;/div&gt;
#end
</content></xwikidoc>